{% extends 'base.html' %}

{% block title %}{{ page.title }}{% endblock %}

{% block content %}
    <!-- Герой-секции -->
    {% for hero in page.hero_sections.all %}
    <section class="relative overflow-hidden hero-gradient" 
             style="--gradient-color: {{ hero.background_gradient }}; --gradient-opacity: {{ hero.gradient_opacity }};">
        {% if hero.background_image %}
        <div class="absolute inset-0 z-0">
            <img src="{{ hero.background_image.url }}" alt="{{ hero.title }}" class="w-full h-full object-cover">
        </div>
        {% endif %}
        <div class="relative z-10 bg-gradient-to-r {{ hero.background_gradient }} text-white py-20 px-4" style="color: {{ hero.text_color }};">
            <div class="container mx-auto">
                <h2 class="text-4xl md:text-5xl font-bold mb-4">{{ hero.title }}</h2>
                <p class="text-xl md:text-2xl mb-8 max-w-2xl">{{ hero.subtitle|safe }}</p>
            </div>
        </div>
    </section>
    {% endfor %}

    <!-- Слайдеры -->
    {% for slider in page.slider_sections.all %}
    <section class="relative overflow-hidden slider-section" 
             data-autoplay="{{ slider.autoplay }}" 
             data-interval="{{ slider.autoplay_interval }}">
        <div class="slider-container flex transition-transform duration-500 ease-in-out">
            {% for slide in slider.slides.all %}
            <div class="slide flex-shrink-0 w-full">
                <div class="bg-gradient-to-r {{ slide.background_color }} text-white py-20 px-4">
                    <div class="container mx-auto flex flex-col md:flex-row items-center">
                        <div class="md:w-1/2 mb-8 md:mb-0 md:pr-8">
                            {% if slide.title %}<h2 class="text-4xl md:text-5xl font-bold mb-4">{{ slide.title }}</h2>{% endif %}
                            {% if slide.subtitle %}<p class="text-xl md:text-2xl mb-8 max-w-2xl">{{ slide.subtitle|linebreaks }}</p>{% endif %}
                            {% if slide.button_text and slide.get_link %}
                            <div class="mt-8">
                                <a href="{{ slide.get_link }}" class="inline-block bg-white text-gray-800 px-8 py-4 rounded-md font-semibold hover:bg-gray-100 transition text-lg">
                                    {{ slide.button_text }}
                                </a>
                            </div>
                            {% endif %}
                        </div>
                        <div class="md:w-1/2">
                            <img src="{{ slide.image.url }}" alt="{{ slide.title }}" class="rounded-lg shadow-lg w-full h-auto max-h-96 object-cover">
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
        {% if slider.show_indicators and slider.slides.all|length > 1 %}
        <div class="absolute bottom-4 left-0 right-0 flex justify-center space-x-2">
            {% for slide in slider.slides.all %}
            <button class="slider-dot w-3 h-3 rounded-full bg-white bg-opacity-50 focus:outline-none" data-index="{{ forloop.counter0 }}"></button>
            {% endfor %}
        </div>
        {% endif %}
        
        {% if slider.show_controls and slider.slides.all|length > 1 %}
        <button class="absolute left-4 top-1/2 transform -translate-y-1/2 bg-white bg-opacity-30 text-white p-3 rounded-full hover:bg-opacity-50 focus:outline-none slider-prev z-10">
            <i class="fas fa-chevron-left text-xl"></i>
        </button>
        <button class="absolute right-4 top-1/2 transform -translate-y-1/2 bg-white bg-opacity-30 text-white p-3 rounded-full hover:bg-opacity-50 focus:outline-none slider-next z-10">
            <i class="fas fa-chevron-right text-xl"></i>
        </button>
        {% endif %}
    </section>
    {% endfor %}

    <!-- Текст с изображением -->
    {% for text_image in page.text_image_sections.all %}
    <section class="py-16 px-4 bg-white">
        <div class="container mx-auto">
            <div class="flex flex-col md:flex-row items-center">
                {% if text_image.image_position == 'left' %}
                <div class="md:w-1/2 mb-8 md:mb-0 md:pr-8">
                    <img src="{{ text_image.image.url }}" alt="{{ text_image.title }}" class="rounded-lg shadow-md w-full h-auto">
                </div>
                {% endif %}
                
                <div class="md:w-1/2 {% if text_image.image_position == 'left' %}md:pl-8{% else %}md:pr-8{% endif %}">
                    <h2 class="text-3xl font-bold text-gray-800 mb-6">{{ text_image.title }}</h2>
                    <div class="text-gray-600 mb-6">{{ text_image.content|safe }}</div>
                    {% if text_image.button_text and text_image.get_link %}
                    <a href="{{ text_image.get_link }}" class="bg-blue-600 text-white px-6 py-3 rounded-md font-semibold hover:bg-blue-700 transition">
                        {{ text_image.button_text }}
                    </a>
                    {% endif %}
                </div>
                
                {% if text_image.image_position == 'right' %}
                <div class="md:w-1/2 mb-8 md:mb-0 md:pl-8">
                    <img src="{{ text_image.image.url }}" alt="{{ text_image.title }}" class="rounded-lg shadow-md w-full h-auto">
                </div>
                {% endif %}
            </div>
        </div>
    </section>
    {% endfor %}

    <!-- Текст с HTML -->
    {% for text_html in page.text_html_sections.all %}
    <section class="py-16 px-4 bg-white">
        <div class="container mx-auto">
            <div class="flex flex-col md:flex-row items-center">
                {% if text_html.html_position == 'left' %}
                <div class="md:w-1/2 mb-8 md:mb-0 md:pr-8">
                    {{ text_html.html_content|safe }}
                </div>
                {% endif %}
                
                <div class="md:w-1/2 {% if text_html.html_position == 'left' %}md:pl-8{% else %}md:pr-8{% endif %}">
                    <h2 class="text-3xl font-bold text-gray-800 mb-6">{{ text_html.title }}</h2>
                    <div class="text-gray-600 mb-6">{{ text_html.content|safe }}</div>
                    {% if text_html.button_text and text_html.get_link %}
                    <a href="{{ text_html.get_link }}" class="bg-blue-600 text-white px-6 py-3 rounded-md font-semibold hover:bg-blue-700 transition">
                        {{ text_html.button_text }}
                    </a>
                    {% endif %}
                </div>
                
                {% if text_html.html_position == 'right' %}
                <div class="md:w-1/2 mb-8 md:mb-0 md:pl-8">
                    {{ text_html.html_content|safe }}
                </div>
                {% endif %}
            </div>
        </div>
    </section>
    {% endfor %}

    <!-- Секции услуг -->
    {% for services_section in page.services_sections.all %}
    <section class="py-16 px-4 bg-gray-50">
        <div class="container mx-auto">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-12">{{ services_section.main_title }}</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                {% for card in services_section.cards.all %}
                <div class="bg-white rounded-xl shadow-md overflow-hidden hover:shadow-lg transition">
                    <div class="h-48 bg-blue-600 flex items-center justify-center" style="background-color: {{ card.icon_color }};">
                        <i class="{{ card.icon }} text-white text-6xl"></i>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">{{ card.title }}</h3>
                        <p class="text-gray-600 mb-4">{{ card.description|safe }}</p>
                        {% if card.button_text and card.get_link %}
                        <a href="{{ card.get_link }}" class="text-blue-600 font-medium hover:text-blue-800 flex items-center">
                            {{ card.button_text }} <i class="fas fa-arrow-right ml-2"></i>
                        </a>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </section>
    {% endfor %}

    <!-- Секции преимуществ -->
    {% for features_section in page.features_sections.all %}
    <section class="py-16 px-4 bg-white">
        <div class="container mx-auto">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-12">{{ features_section.main_title }}</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                {% for feature in features_section.features.all %}
                <div class="text-center p-6">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4" style="background-color: {{ feature.icon_color }}20;">
                        <i class="{{ feature.icon }} text-xl" style="color: {{ feature.icon_color }};"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">{{ feature.title }}</h3>
                    <p class="text-gray-600">{{ feature.description|safe }}</p>
                </div>
                {% endfor %}
            </div>
        </div>
    </section>
    {% endfor %}

    <!-- Галереи -->
    {% for gallery in page.gallery_sections.all %}
    <section class="py-16 px-4 bg-gray-50">
        <div class="container mx-auto">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-12">{{ gallery.title }}</h2>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
                {% for image in gallery.images.all %}
                <div class="bg-white rounded-lg overflow-hidden shadow-md">
                    <img src="{{ image.image.url }}" alt="{{ image.title }}" class="w-full h-64 object-cover">
                    {% if image.title or image.description %}
                    <div class="p-4">
                        {% if image.title %}<h3 class="text-lg font-semibold text-gray-800 mb-2">{{ image.title }}</h3>{% endif %}
                        {% if image.description %}<p class="text-gray-600 text-sm">{{ image.description|safe }}</p>{% endif %}
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        </div>
    </section>
    {% endfor %}
{% endblock %}